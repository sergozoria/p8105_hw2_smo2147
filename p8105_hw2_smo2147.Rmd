---
title: "Homework 2 - P8105"
author: "Sergio Ozoria Ramírez (smo2147)"
date: "2025-10-01"
output: github_document
---

# Problem 0

#### Loading necessary packages

```{r setup, message =  FALSE}
library(tidyverse)
```

# Problem 1

#### Cleaning the `pols-month.csv` dataset 

```{r tidying pls dataset, message =  FALSE}
pls_month_df =
  read_csv("./Data/FiveThirtyEight/pols-month.csv", na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
  separate(mon, sep = "-", into = c("year", "month", "day")) |>
  mutate(across(year:day, as.integer),
         month = factor(month,
                        levels = 1:12,
                        labels = tolower(month.abb))) |> 
  mutate(president = case_when(
         prez_gop == 1 ~ "gop",
         prez_gop == 0 ~ "dem",
         TRUE ~ NA_character_ )) |> 
  relocate(year, month, president) |> 
  select(-day, -prez_gop, -prez_dem) |> 
  arrange(year, month)
```

#### Cleaning the `snp.csv` dataset 

```{r tidying snp dataset, message =  FALSE}
stock_market_df =
  read_csv("./Data/FiveThirtyEight/snp.csv", na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
  separate(date, sep = "/", into = c("month", "day", "year")) |> 
  mutate(
    across(month:year, as.integer),
    year = ifelse(year 
                  <= 49, year + 2000, 
                  year + 1900),
    month = factor(month, 
                   levels = 1:12, 
                   labels = tolower(month.abb))) |> 
  relocate(year) |> 
  select(-day) |> 
  arrange(year, month)
```

#### Tidying the `umeployment` dataset

```{r tidying unemp dataset, message =  FALSE}
unemp_df =
  read_csv("./Data/FiveThirtyEight/unemployment.csv", na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemp_rate") |> 
  mutate(
    year = as.integer(year),
    month = factor(month,
                   levels = tolower(month.abb))) |> 
  arrange(year, month)
```

#### Merging `snp`, `pols` and `unemployment` datasets

```{r tidying merged dataset, message =  FALSE}
pls_snp_unemp_df =
  left_join(pls_month_df, stock_market_df, by = c("year", "month")) |>
  left_join(unemp_df, by = c("year", "month")) |> 
  arrange(year, month)
```

#### Explanation of Politician, Stock Market, and Unemployment Datasets

###### Description of National Democratic and Republic Politician Dataset

To start with dataset **`pls_month_df`**, it contains information about national politicians who are either democratic or republican across across time. The dataset originally had the **`mon`** variable, indicating the date of count, which I separated into columns **`year`**, **`month`**, and **`day`** using the **`separate`** function. It also had two variables, **`prez_gop`** and **`prez_dem`**, indicating whether sitting president was republican or democratic on the associated date of count, which I mutated into a new variable called **`president`**. After tidying the dataset, the dataset was left with **`r nrow(pls_month_df)`** observations and **`r ncol(pls_month_df)`** variables. The range of years for national politicians goes from **`r pls_month_df |> pull(year) |> min()`** to **`r pls_month_df |> pull(year) |> max()`**, which tell us the year of observation. Along with the **`year`** variable, we get more information from the **`month`** and **`president`** variables, which also indicate the month of observation and indication of whether the president was republican or democratic at the time of observation. The remaining variables in this dataset gives us information about republican and democratic representatives, governors, and senators on the associated year and month of observation. 

###### Description of Standard & Poor’s Stock Market Index Dataset

The **`stock_market_df`** dataset contains information about the market index, which gives you a representative measure of the stock market at the time of observation. The dataset originally had the **`date`** variable, indicating the date of observation, which I separated into columns **`year`**, **`month`**, and **`day`** using the **`separate`** function. After tidying the dataset, the dataset was left with **`r nrow(stock_market_df)`** observations and **`r ncol(stock_market_df)`** variables.  The range of years for the closing values of the S&P stock index goes from **`r stock_market_df |> pull(year) |> min()`** to **`r stock_market_df |> pull(year) |> max()`**, which tell us the year of observation. These variable basically gives us insight on the closing values of the stock market index based on the associated date, as depicted by the **`close`** variable at the end of the **`year`** and **`month`** observations. 

###### Description of Unemployment Rate Dataset



###### Description of Merged Politician, Stock Market, and Unemployment Datasets



The range of years covered in the dataset, `pls_snp_unemp_df`, ranges from **`r pls_snp_unemp_df |> pull(year) |> min()`** to **`r pls_snp_unemp_df |> pull(year) |> max()`**. It also contains **`r nrow(pls_snp_unemp_df)`**  rows and **`r ncol(pls_snp_unemp_df)`** columns. Key variables that are important to this dataset include the `year`, `month`, `president`, `close`, and `unemp_rate` variables
