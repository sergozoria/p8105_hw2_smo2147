Homework 2 - P8105
================
Sergio Ozoria RamÃ­rez (smo2147)
2025-10-01

# Problem 0.0

``` r
library(tidyverse)
```

# Problem 1

#### Cleaning the `pols-month.csv` dataset

``` r
pls_month_df =
  read_csv("./Data/FiveThirtyEight/pols-month.csv", na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
  separate(mon, sep = "-", into = c("year", "month", "day")) |>
  arrange(year, month, day) |> 
  mutate(across(year:day, as.integer),
    month = case_match(
      month,
      1 ~ "jan", 2 ~ "feb", 3 ~ "mar",
      4 ~ "apr", 5 ~ "may", 6 ~ "jun",
      7 ~ "jul", 8 ~ "aug", 9 ~ "sept",
      10 ~ "oct", 11 ~ "nov", 12 ~ "dec"
    )) |> 
  mutate(president = case_when(
         prez_gop == 1 ~ "gop",
         prez_gop == 0 ~ "dem",
         )) |> 
  relocate(year, month, president) |> 
  select(-day, -prez_gop, -prez_dem) 
```

#### Cleaning the `snp.csv` dataset

``` r
stock_market_df =
  read_csv("./Data/FiveThirtyEight/snp.csv", na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
  separate(date, sep = "/", into = c("month", "day", "year")) |> 
  mutate(across(c(month, day, year), as.integer),
    year = ifelse(year <= 49, year + 2000, year + 1900)) |> 
  arrange(year, month) |> 
  select(year, month, close, everything(), -day) |> 
  mutate(
    month = case_match(month,
      1 ~ "jan", 2 ~ "feb", 3 ~ "mar",
      4 ~ "apr", 5 ~ "may", 6 ~ "jun",
      7 ~ "jul", 8 ~ "aug", 9 ~ "sept",
      10 ~ "oct", 11 ~ "nov", 12 ~ "dec",
  ))
```

#### Tidying the `umeployment` dataset

``` r
unemp_df =
  read_csv("./Data/FiveThirtyEight/unemployment.csv", na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemp_rate") |> 
  mutate(year = as.integer(year)) 
```

#### Merging `snp`, `pols` and `unemployment` datasets

``` r
pls_snp_unemp_df =
  left_join(pls_month_df, stock_market_df, by = c("year", "month")) |> 
  left_join(unemp_df, by = c("year", "month")) |> 
  arrange(year, month)
```
